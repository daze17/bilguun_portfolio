---
title: "GNU Stow"
publishedAt: "2024-10-09"
summary: ".dotfiles-г хэрхэн удирдах вэ"
---

Dotfiles буюу тохиргооны `.zshrc` `.vimrc` `.bashrc` гэх мэт файлуудаа хэрхэн удирдах вэ.

Шинэ зүйл туршиж үзэж байхдаа өмнө нь хэвийн ажилж байсан тохиргоогоо санаандгүй өөрчилж л байсан биздээ.
Ажлын компьютер хувийн компьютер дээрх тохиргоонууд нэг л өөр байгаад байна уу? Аль эсвэл компьютер дээрх мэдээллүүд чинь уствал дахиад л бүх тохиргоонуудыг суулгах хэрэг гарна шүү дээ.

Энэ асуудлуудыг version control ашиглаж шийдэх боломжтой. Гэвч dotfiles-ууд нь систем дээр эн тэндгүй тархсан байдалтай байдаг тул бидний мэдэх
git version control ашиглахад асуудлууд гардаг.

![gnu_stow](/blog/gnu_stow/gnu_stow.png)

Харин үүнийг би GNU stow ашиглаж шийдсэн юм.

## GNU Stow гэж юу вэ? тодорхойлолт

GNU Stow бол симлинк ферм менежер /symlink farm manager/ буюу энэ нь таны систем дээрх тохиргооны файлуудад symlinks үүсгэж нэг газар бүгдийг нь хадгалахад тусалдаг гэсэн үг.
Өөрөөр хэлбэл HOME цэсэнд байгаа тохиргооны файлыг өөр хавтсанд байгаа файлтай холбож өгнө.
Маш энгийнээр тайлбарлавал HOME цэсэн дээр байгаа файлыг өөрчлөхөд бидний шинээр үүсгэсэн фолдер доторх файлууд зэрэг өөрчлөгдөнө гэсэн үг.

### Гол онцлогууд:

1. **Symlink farm management**: Stow нь таны үүсгэсэн dotfiles хавтсанаас HOME цэсэн дээрх тохиргоог үүсгэж удирдахад тусална.
2. **Modular organization**: dotfile уудыг module хэлбэрээр бүлэглэж deploy хийхэд хялбар болгоно.
3. **Non-destructive**: Stow нь одоо байгаа файлуудыг дарж бичихгүй бөгөөд, таны одоогын байгаа тохиргооны файлд аюулгүй.
4. **Version control friendly**: Файлууд нь нэг газар төвлөрсөн болхоор git version control ашиглаж өөрчлөлтийг хянахад хялбар болно.

Энэ нь таны HOME цэсэн дээрх тохиргооны файлуудтай яг ижилхэн бүтэцээр үүсэхийг анхаараарай.

### Бүтэц ингэж харагдана:

GNU Stow нь **package** буюу багц системтэй ажилладаг - dotfiles хавтас доторх дэд хавтас бүр таны HOME директорийн бүтцийг дуурайна:

```
home/
    dotfiles/
        zsh/
            .zshrc
            .config/
                zsh/
                    [...zsh тохиргооны файлууд]
        vim/
            .vimrc
            .vim/
                [...vim файлууд]
        bash/
            .bashrc
            .bash_profile
            .bash_logout
```

Дараагийн хэсгүүдэд бид таны dotfiles-ыг үр дүнтэй удирдахын тулд GNU Stow-г хэрхэн тохируулж, ашиглах талаар судалж үзэх болно.

1. stow суулгах
   Хэрвээ та MacOS ашигладаг мөн homebrew суулгасан болон дараах командыг уншуулахад л болно

```
   brew install stow
```

2. Шинэ dotfiles хавтас үүсгэх

```
   mkdir $HOME/dotfiles
   cd ~/dotfiles
```

3. Тохиргооны package хавтсууд үүсгэх. Жишээ болгон zsh-ээс эхэлье:

```
   mkdir -p ~/dotfiles/zsh
```

4. Тохиргооны файлуудыг package хавтсанд хуулах, дэд хавтсын бүтцийг хадгална.

.zshrc файлыг (HOME дээр шууд байдаг):
```
   mv ~/.zshrc ~/dotfiles/zsh/.zshrc
```

.config доторх файлуудыг (HOME/.config дээр байдаг):
```
   mkdir -p ~/dotfiles/zsh/.config
   mv ~/.config/zsh ~/dotfiles/zsh/.config/
```

5. Symlinks үүсгэх

**dotfiles хавтас** руугаа ороод Stow ашиглан симлинк үүсгэнэ:

```
cd ~/dotfiles
stow zsh
```

Энэ нь таны HOME цэсэн дээр ~/dotfiles/zsh/ хавтсан дахь файлууд руу симлинк үүсгэнэ.

6. Шалгаж үзэх

HOME цэсэн дээрх симлинкүүдийг шалгаарай:

```
   ls -la ~/ | grep zshrc
```

Ингэж харагдах ёстой: `.zshrc -> dotfiles/zsh/.zshrc`

Хэрвээ амжилттай үүссэн бол таны dotfiles хавтас дараах зураг шиг харагдах болно:

![dotfiles directory](/blog/gnu_stow/dotfiles_directory.png)

Бидний HOME цэсэн дээр симлинкүүд ингэж харагдана:

![old config directory](/blog/gnu_stow/old_config_directory.png)

7. Git-ээр хянах

Git ашиглах нь таны **өөрчлөлтүүдийг хянах, буцаах, өөр өөр компьютерүүд дээр dotfiles-ыг синк хийх** боломжийг олгоно. Git эхлүүлж, dotfiles-аа commit хийе:

```
   cd ~/dotfiles
   git init
   git add .
   git commit -m "Initial commit of dotfiles"
```

**Зөвлөмж:** Бусад хэрэгслүүдэд (vim, tmux, bash гэх мэт) нэмэлт package-үүд үүсгэж болно. Дараа нь package бүрт `stow <package-нэр>` ажиллуулах, эсвэл бүх package-үүдийг зэрэг stow хийхийн тулд `stow */` ашиглаарай.

### Нэмэлт:

Ignore файлууд

Та хэрвээ version control тохируулсан бол `.git` файл хавтас дотор чинь байх болно гэсэн үг.
Хэрвээ та stow нь `.git` симлинк хийнэ гэж бодож байвал санаа зовох хэрэггүй. Яагаад гэвэл stow нь `.git` файлыг автоматаар ignore хийх болно.

Өөрчлөлт хийгдээгүй stow ignore файл ингэж харагдана
![default_ignore](/blog/gnu_stow/default_ignore.png)

Хэрвээ та үүн дээр нэмэлтээр өөрчлөлтүүд хийх гэж байгаа бол `.stow-local-ignore` гэж үүсгээд өөрчлөлтүүдээ нэмэх боломжтой.
